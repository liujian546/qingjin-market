# 校园线上交易平台

这是一个专为校园环境设计的线上交易平台，学生可以在上面买卖物品，支持线上支付和线下交易两种模式。

## 功能特性

1. **用户系统**：学号注册、手机号验证、唯一账号
2. **商品管理**：分类管理、图片上传、搜索功能
3. **交易系统**：购买请求、交易确认、手续费计算
4. **信用机制**：举报系统、管理员处理、用户封禁
5. **支付系统**：微信支付宝支付
6. **移动端支持**：PWA、原生APP打包
7. **管理员功能**：平台监控、界面自定义

## 安装和运行

### 方法一：直接运行（适用于Windows）

1. 双击 `start_app.bat` 文件启动应用
2. 在浏览器中访问 `http://127.0.0.1:5000`

### 方法二：命令行运行

1. 确保已安装Python 3.6+
2. 创建虚拟环境：
   ```
   python -m venv venv
   ```
3. 激活虚拟环境：
   - Windows: `venv\Scripts\activate`
   - macOS/Linux: `source venv/bin/activate`
4. 安装依赖：
   ```
   pip install -r requirements.txt
   ```
5. 初始化管理员账户：
   ```
   python init_admin.py
   ```
6. 运行应用：
   ```
   python app.py
   ```
7. 在浏览器中访问 `http://127.0.0.1:5000`

## 使用说明

1. 注册账户并登录（首次使用学号20250001和密码admin123登录可访问管理员功能）
2. 发布要出售的商品信息（支持图片上传和分类）
3. 浏览其他用户发布的商品（支持分类筛选和关键词搜索）
4. 购买商品并完成支付（支持微信和支付宝）
5. 交易完成后标记为已完成
6. 如遇到问题可以举报对方

## 手续费规则

- 默认手续费：0.10元（1毛钱）
- 交易5次以上：0.05元（5分钱）
- 交易10次以上：0.01元（1分钱）

## 技术架构

- 后端：Flask (Python)
- 数据库：SQLite
- 前端：Bootstrap 5 + Jinja2模板
- 图片处理：Pillow
- 支付处理：微信支付、支付宝

## 移动端打包

应用可以打包为移动应用，详细说明请参见 [MOBILE_PACKAGING_GUIDE.md](MOBILE_PACKAGING_GUIDE.md)。

应用支持以下移动化方案：
1. **PWA (渐进式Web应用)** - 可以直接在移动浏览器中使用并添加到主屏幕
2. **Cordova/PhoneGap** - 打包为原生移动应用
3. **通过第三方工具** 如 PWA Builder 打包为应用商店应用

## 管理员功能

- 举报处理：处理用户举报，封禁违规用户
- 平台监控：监控平台运行状态
- 界面自定义：自定义平台界面和设置
- 手续费测试：测试手续费计算逻辑

## 支付功能

应用已集成微信支付宝支付功能：
- 买家确认收货后资金才会转给卖家
- 支持退款和争议处理
- 符合支付安全标准
- 支持支付回调处理

## 开发计划

- [x] 基础交易平台功能
- [x] 商品分类和搜索
- [x] 图片上传功能
- [x] 学号注册和手机号验证
- [x] 美化界面设计
- [x] 管理员功能
- [x] 微信支付宝支付集成
- [x] 短信验证码功能
- [x] 移动端APP打包支持

## 配置说明

1. **支付配置**：在 `payment_config.py` 中配置微信支付和支付宝的商户信息
2. **短信配置**：在 `sms_verification.py` 中集成实际的短信服务API
3. **管理员账户**：运行 `init_admin.py` 初始化管理员账户

## 部署建议

1. 生产环境建议使用Nginx + Gunicorn部署
2. 数据库建议使用MySQL或PostgreSQL替代SQLite
3. 静态文件建议使用CDN加速
4. 支付回调地址需要公网可访问